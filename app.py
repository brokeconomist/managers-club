import streamlit as st
import pandas as pd
import numpy as np

st.set_page_config(page_title="Managers' Club", layout="centered")

# Sidebar navigation
st.sidebar.title("ğŸ”§ Î•ÏÎ³Î±Î»ÎµÎ¯Î± Î‘Î½Î¬Î»Ï…ÏƒÎ·Ï‚")
tool = st.sidebar.radio("Î•Ï€Î¹Î»Î­Î¾Ï„Îµ ÎµÏÎ³Î±Î»ÎµÎ¯Î¿:", [
    "ğŸ  Î‘ÏÏ‡Î¹ÎºÎ®",
    "ğŸ“Š Î‘Î½Î¬Î»Ï…ÏƒÎ· ÎÎµÎºÏÎ¿Ï Î£Î·Î¼ÎµÎ¯Î¿Ï…",
    "ğŸ” ÎœÎµÏ„Î±Î²Î¿Î»Î® ÎÎµÎºÏÎ¿Ï Î£Î·Î¼ÎµÎ¯Î¿Ï… (Î¤Î¹Î¼Î®/ÎšÏŒÏƒÏ„Î¿Ï‚/Î•Ï€Î­Î½Î´Ï…ÏƒÎ·)",
    "ğŸ‘¥ Î‘Î½Î¬Î»Ï…ÏƒÎ· CLV",
    "ğŸ’¸ Î‘Î½Î¬Î»Ï…ÏƒÎ· ÎœÎµÎ¯Ï‰ÏƒÎ·Ï‚ Î¤Î¹Î¼Î®Ï‚ Î ÏÎ¿ÏŠÏŒÎ½Ï„Î¿Ï‚"
])

st.title("ğŸ“ˆ Managersâ€™ Club â€“ ÎŸÎ¹ÎºÎ¿Î½Î¿Î¼Î¹ÎºÎ¬ Î•ÏÎ³Î±Î»ÎµÎ¯Î±")

# Tool 1: Î‘ÏÏ‡Î¹ÎºÎ®
if tool == "ğŸ  Î‘ÏÏ‡Î¹ÎºÎ®":
    st.markdown("""
    ÎšÎ±Î»ÏÏ‚ Î®ÏÎ¸Î±Ï„Îµ ÏƒÏ„Î¿ **Managersâ€™ Club**, Ï„Î·Î½ online ÎµÏÎ³Î±Î»ÎµÎ¹Î¿Î¸Î®ÎºÎ· Î³Î¹Î± Ï†Î¿Î¹Ï„Î·Ï„Î­Ï‚ & Î¼Î¹ÎºÏÎ¿Î¼ÎµÏƒÎ±Î¯Î¿Ï…Ï‚ ÎµÏ€Î¹Ï‡ÎµÎ¹ÏÎ·Î¼Î±Ï„Î¯ÎµÏ‚.  
    Î•Î´Ï Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î±Î½Î±Î»ÏÏƒÎµÏ„Îµ ÏƒÎ·Î¼ÎµÎ¯Î± Î¹ÏƒÎ¿ÏÏÎ¿Ï€Î¯Î±Ï‚, Î½Î± Ï€ÏÎ¿Î²Î»Î­ÏˆÎµÏ„Îµ Ï„Î·Î½ Î±Î¾Î¯Î± Ï€ÎµÎ»Î±Ï„ÏÎ½, Î½Î± Î´ÎµÎ¯Ï„Îµ ÎµÏ€Î¹Î´ÏÎ¬ÏƒÎµÎ¹Ï‚ Î¼ÎµÏ„Î±Î²Î¿Î»ÏÎ½ Ï„Î¹Î¼Î®Ï‚ & ÎµÏ€ÎµÎ½Î´ÏÏƒÎµÏ‰Î½, ÎºÎ±Î¹ Î¬Î»Î»Î± Ï€Î¿Î»Î»Î¬.
    """)

# Tool 2: Î’Î±ÏƒÎ¹ÎºÎ® Î‘Î½Î¬Î»Ï…ÏƒÎ· ÎÎµÎºÏÎ¿Ï Î£Î·Î¼ÎµÎ¯Î¿Ï…
elif tool == "ğŸ“Š Î‘Î½Î¬Î»Ï…ÏƒÎ· ÎÎµÎºÏÎ¿Ï Î£Î·Î¼ÎµÎ¯Î¿Ï…":
    st.subheader("ğŸ“Š Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ ÎÎµÎºÏÎ¿Ï Î£Î·Î¼ÎµÎ¯Î¿Ï…")
    p = st.number_input("Î¤Î¹Î¼Î® Î ÏÎ»Î·ÏƒÎ·Ï‚ Î±Î½Î¬ Î¼Î¿Î½Î¬Î´Î± (â‚¬)", min_value=0.01)
    vcu = st.number_input("ÎœÎµÏ„Î±Î²Î»Î·Ï„ÏŒ ÎšÏŒÏƒÏ„Î¿Ï‚ Î±Î½Î¬ Î¼Î¿Î½Î¬Î´Î± (â‚¬)", min_value=0.00)
    fc = st.number_input("Î£Ï„Î±Î¸ÎµÏÎ¬ ÎˆÎ¾Î¿Î´Î± (â‚¬)", min_value=0.00)

    if p > vcu:
        q_be = fc / (p - vcu)
        st.success(f"ğŸ”¹ ÎÎµÎºÏÏŒ Î£Î·Î¼ÎµÎ¯Î¿: {q_be:.2f} Î¼Î¿Î½Î¬Î´ÎµÏ‚")
    elif p > 0:
        st.error("âš ï¸ Î— Ï„Î¹Î¼Î® Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ· Î±Ï€ÏŒ Ï„Î¿ Î¼ÎµÏ„Î±Î²Î»Î·Ï„ÏŒ ÎºÏŒÏƒÏ„Î¿Ï‚.")

# Tool 3: ÎÎµÎºÏÏŒ Î£Î·Î¼ÎµÎ¯Î¿ Î¼Îµ Î•Ï€Î­Î½Î´Ï…ÏƒÎ·/ÎÎ­Î± Î¤Î¹Î¼Î®
elif tool == "ğŸ” ÎœÎµÏ„Î±Î²Î¿Î»Î® ÎÎµÎºÏÎ¿Ï Î£Î·Î¼ÎµÎ¯Î¿Ï… (Î¤Î¹Î¼Î®/ÎšÏŒÏƒÏ„Î¿Ï‚/Î•Ï€Î­Î½Î´Ï…ÏƒÎ·)":
    st.subheader("ğŸ” Î‘Î½Î¬Î»Ï…ÏƒÎ· ÎœÎµÏ„Î±Î²Î¿Î»Î®Ï‚ ÎÎµÎºÏÎ¿Ï Î£Î·Î¼ÎµÎ¯Î¿Ï…")
    p = st.number_input("Î‘ÏÏ‡Î¹ÎºÎ® Î¤Î¹Î¼Î® Î ÏÎ»Î·ÏƒÎ·Ï‚ (â‚¬)", min_value=0.01)
    vcu = st.number_input("Î‘ÏÏ‡Î¹ÎºÏŒ ÎœÎµÏ„Î±Î²Î»Î·Ï„ÏŒ ÎšÏŒÏƒÏ„Î¿Ï‚ (â‚¬)", min_value=0.00)
    fc = st.number_input("Î‘ÏÏ‡Î¹ÎºÎ¬ Î£Ï„Î±Î¸ÎµÏÎ¬ ÎˆÎ¾Î¿Î´Î± (â‚¬)", min_value=0.00)

    delta_fc = st.number_input("Î•Ï€Î­Î½Î´Ï…ÏƒÎ·/ÎœÎµÏ„Î±Î²Î¿Î»Î® Î£Ï„Î±Î¸ÎµÏÏÎ½ Î•Î¾ÏŒÎ´Ï‰Î½ (â‚¬)", value=0.0)
    new_p = st.number_input("ÎÎ­Î± Î¤Î¹Î¼Î® Î ÏÎ»Î·ÏƒÎ·Ï‚ (â‚¬)", value=p)
    new_vcu = st.number_input("ÎÎ­Î¿ ÎœÎµÏ„Î±Î²Î»Î·Ï„ÏŒ ÎšÏŒÏƒÏ„Î¿Ï‚ (â‚¬)", value=vcu)

    if new_p > new_vcu:
        old_be = fc / (p - vcu)
        new_be = (fc + delta_fc) / (new_p - new_vcu)
        diff = new_be - old_be
        st.info(f"ğŸ”¹ Î Î±Î»Î±Î¹ÏŒ ÎÎµÎºÏÏŒ Î£Î·Î¼ÎµÎ¯Î¿: {old_be:.2f}")
        st.success(f"ğŸ”¹ ÎÎ­Î¿ ÎÎµÎºÏÏŒ Î£Î·Î¼ÎµÎ¯Î¿: {new_be:.2f}")
        st.write(f"ğŸ”„ ÎœÎµÏ„Î±Î²Î¿Î»Î®: {'Î‘ÏÎ¾Î·ÏƒÎ·' if diff > 0 else 'ÎœÎµÎ¯Ï‰ÏƒÎ·'} {abs(diff):.2f} Î¼Î¿Î½Î¬Î´Ï‰Î½")
    elif new_p > 0:
        st.error("âš ï¸ Î— Î½Î­Î± Ï„Î¹Î¼Î® Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ· Î±Ï€ÏŒ Ï„Î¿ Î½Î­Î¿ Î¼ÎµÏ„Î±Î²Î»Î·Ï„ÏŒ ÎºÏŒÏƒÏ„Î¿Ï‚.")

# Tool 4: Î‘Î½Î¬Î»Ï…ÏƒÎ· CLV
elif tool == "ğŸ‘¥ Î‘Î½Î¬Î»Ï…ÏƒÎ· CLV":
    st.subheader("ğŸ‘¥ Î‘Î½Î¬Î»Ï…ÏƒÎ· Customer Lifetime Value (CLV)")

    margin = st.number_input("ÎœÎ­ÏƒÎ¿ ÎšÎ­ÏÎ´Î¿Ï‚ Î±Î½Î¬ Î ÎµÎ»Î¬Ï„Î· Î±Î½Î¬ Î ÎµÏÎ¯Î¿Î´Î¿ (â‚¬)", min_value=0.0)
    retention = st.slider("Î Î¹Î¸Î±Î½ÏŒÏ„Î·Ï„Î± Î”Î¹Î±Ï„Î®ÏÎ·ÏƒÎ·Ï‚ Î ÎµÎ»Î¬Ï„Î· (%)", min_value=0, max_value=100)
    discount_rate = st.slider("Î•Ï€Î¹Ï„ÏŒÎºÎ¹Î¿ ÎˆÎºÏ€Ï„Ï‰ÏƒÎ·Ï‚ (%)", min_value=0, max_value=100)

    if retention < 100:
        r = retention / 100
        d = discount_rate / 100
        try:
            clv = margin * r / (1 + d - r)
            st.success(f"ğŸ“ˆ Î•ÎºÏ„Î¹Î¼ÏÎ¼ÎµÎ½Î¿ CLV: {clv:.2f} â‚¬")
        except ZeroDivisionError:
            st.error("âš ï¸ ÎœÎ· Î­Î³ÎºÏ…ÏÎ¿Ï‚ ÏƒÏ…Î½Î´Ï…Î±ÏƒÎ¼ÏŒÏ‚ r ÎºÎ±Î¹ d.")
    else:
        st.error("âš ï¸ Î— Ï€Î¹Î¸Î±Î½ÏŒÏ„Î·Ï„Î± Î´Î¹Î±Ï„Î®ÏÎ·ÏƒÎ·Ï‚ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ < 100%.")

# Tool 5: Î‘Î½Î¬Î»Ï…ÏƒÎ· ÎœÎµÎ¯Ï‰ÏƒÎ·Ï‚ Î¤Î¹Î¼Î®Ï‚
elif tool == "ğŸ’¸ Î‘Î½Î¬Î»Ï…ÏƒÎ· ÎœÎµÎ¯Ï‰ÏƒÎ·Ï‚ Î¤Î¹Î¼Î®Ï‚ Î ÏÎ¿ÏŠÏŒÎ½Ï„Î¿Ï‚":
    st.subheader("ğŸ’¸ Î‘Î½Î¬Î»Ï…ÏƒÎ· ÎœÎµÎ¯Ï‰ÏƒÎ·Ï‚ Î¤Î¹Î¼Î®Ï‚ Î ÏÎ¿ÏŠÏŒÎ½Ï„Ï‰Î½")

    # Î•Ï€Î¹Î»Î¿Î³Î® Ï€ÏÎ¿ÏŠÏŒÎ½Ï„Î¿Ï‚
    product = st.selectbox("Î•Ï€Î¹Î»Î­Î¾Ï„Îµ Ï€ÏÎ¿ÏŠÏŒÎ½:", ["Î‘", "Î’", "Î“", "Î”"])
    
    price = st.number_input("Î‘ÏÏ‡Î¹ÎºÎ® Î¤Î¹Î¼Î® Î ÏÎ»Î·ÏƒÎ·Ï‚ (â‚¬)", min_value=0.01)
    discount_pct = st.slider("Î Î¿ÏƒÎ¿ÏƒÏ„ÏŒ ÎœÎµÎ¯Ï‰ÏƒÎ·Ï‚ Î¤Î¹Î¼Î®Ï‚ (%)", 0, 100, 10)
    new_price = price * (1 - discount_pct / 100)

    vcu = st.number_input("ÎœÎµÏ„Î±Î²Î»Î·Ï„ÏŒ ÎšÏŒÏƒÏ„Î¿Ï‚ (â‚¬)", min_value=0.00)
    fc = st.number_input("Î£Ï„Î±Î¸ÎµÏÎ¬ ÎˆÎ¾Î¿Î´Î± (â‚¬)", min_value=0.00)

    st.write(f"ğŸ”» ÎÎ­Î± Î¤Î¹Î¼Î® Î¼ÎµÏ„Î¬ Î±Ï€ÏŒ {discount_pct}% Î¼ÎµÎ¯Ï‰ÏƒÎ·: **{new_price:.2f} â‚¬**")

    if new_price > vcu:
        new_be = fc / (new_price - vcu)
        st.success(f"ğŸ“ ÎÎ­Î¿ ÎÎµÎºÏÏŒ Î£Î·Î¼ÎµÎ¯Î¿ Î³Î¹Î± Ï„Î¿ Ï€ÏÎ¿ÏŠÏŒÎ½ {product}: {new_be:.2f} Î¼Î¿Î½Î¬Î´ÎµÏ‚")
    elif new_price > 0:
        st.error("âš ï¸ Î— Î½Î­Î± Ï„Î¹Î¼Î® Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ· Î±Ï€ÏŒ Ï„Î¿ Î¼ÎµÏ„Î±Î²Î»Î·Ï„ÏŒ ÎºÏŒÏƒÏ„Î¿Ï‚.")
